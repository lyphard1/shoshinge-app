# shoshinge-app

このリポジトリは「正信偈」や和讃の音声再生・表示を行うWebアプリの開発プロジェクトです。

## 概要
- 正信偈や和讃のテキスト表示
- 音声ファイル（mp3/m4a）の再生機能
- HTMLファイルによるUI試作
- 開発途中のため、機能や構成は今後変更される可能性があります

## ディレクトリ構成
- `audio/` : 音声ファイル（shoshinge.m4a, nenbutuwasan.mp3 など）
- 各種HTMLファイル : UIやロジックの試作

## 今後の予定
- UIの改善
- 音声再生機能の拡充
- 振り仮名表示や句長調整などの機能追加

## 注意事項
- 本プロジェクトは現在開発途中です。仕様やファイル構成は予告なく変更される場合があります。


## メインHTMLファイルの構造説明

### shoshinge_prototype.html 構造説明

#### 1. 概要
- 正信偈・念仏和讃のテキスト表示と音声再生ができるWebアプリです。
- ルビ（ふりがな）表示、句ごとのハイライト、音声と連動した表示切替が特徴です。
- **2025/08/27更新**: ページ高さ固定、句束中央寄せ、余白削減の UI/UX改善を実装

#### 2. 主な構成

- `<head>`
	- ページタイトル・日本語設定
	- CSS（縦書き表示、ボタン・ハイライト・レイアウト等のスタイル）
	- **新機能**: CSS変数 `--page-fixed-height` による動的高さ制御

- `<body>`
	- 見出し（h1）：「正信偈・念仏和讃」
	- コントロール領域（`#controlsContainer`）
		- モード切替ボタン（正信偈／念仏和讃）
		- 再生・一時停止ボタン
		- 再生位置バー（クリックでシーク可能）
	- 音声再生用 `<audio>` タグ（初期は正信偈音声）
	- ページ表示領域（`#pagesContainer`）
		- 句ごとに縦書きで表示、ルビ付き
		- 再生中の句はハイライト
		- 句クリックで該当箇所から音声再生
		- **新機能**: `.pageInner` ラッパーによる句束中央寄せ

- `<script>`
	- 音声ファイル切替（正信偈／和讃）
	- ページ・句データ（テキスト・ルビ・再生タイミング）
	- ページ生成・表示切替・ハイライト処理
	- 再生・一時停止・進捗バー・エラー処理
	- 句クリックで該当箇所から再生
	- **新機能**: `computeFixedPageHeight()` による動的高さ固定

#### 3. 主な機能
- モード切替（正信偈／念仏和讃）
- 音声再生・一時停止・シーク
- 句ごとのハイライト（音声と連動）
- ルビ（ふりがな）表示
- 句クリックで該当箇所から再生
- **新機能（2025/08/27）**:
  - ページ高さ自動固定（句の長さに関係なく一定）
  - 句束の中央寄せ（句数が可変でも中央配置）
  - 縦方向余白削減とレスポンシブ対応

#### 4. 技術的実装詳細
- **ページ高さ固定**: 各モードの全ページを計測し最長ページに合わせて CSS変数で制御
- **句束中央寄せ**: `.pageInner` ラッパーと Flexbox を使用した中央配置
- **リサイズ対応**: ウィンドウサイズ変更とモード切替時の動的再計算
- **パフォーマンス最適化**: デバウンス処理による計算負荷軽減

#### 5. 備考
- 他のHTMLファイルはバックアップ用です。
- 音声ファイルは `audio/` フォルダに格納されています。
- 関連画像は `image/` フォルダに格納されています。

## 更新履歴

### 2025/08/27
- **UI/UX大幅改善実装**
  - ページ高さを句の長さに関係なく固定（最長ページ基準）
  - 句束の中央寄せ実装（句数が可変でも中央配置）
  - 縦方向余白の削減とレイアウト最適化
  - `computeFixedPageHeight()` 関数と `.pageInner` ラッパーの導入
  - ウィンドウリサイズとモード切替時の動的再計算機能

### 2025/08/25
- `shoshinge_prototype.html` の念仏和讃モードを修正
  - ページの構成を新しいレイアウトに変更
  - 各ページに対応する画像表示を修正
  - 画像切り替えロジックを、句ごとからページごとに変更

## ライセンス
- ライセンスは未定です。
